<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <title>NovaBuk Blog Admin Dashboard</title>
    <style>
      *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

      :root {
        --primary: #35bac9;
        --primary-light: #7ecad7;
        --sidebar-width: 250px;
        --header-h: 70px;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: #f0f4f8;
        color: #333;
        overflow-x: hidden;
      }

      /* â”€â”€ LOGIN PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #loginPage {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background: linear-gradient(135deg, var(--primary-light), var(--primary));
        padding: 16px;
      }

      .login-box {
        background: white;
        padding: clamp(24px, 5vw, 40px);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        width: 100%;
        max-width: 420px;
      }

      .login-box h2 { text-align: center; margin-bottom: 28px; color: #1a1a1a; }

      /* â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #dashboard { display: flex; min-height: 100vh; }

      /* â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .sidebar {
        width: var(--sidebar-width);
        background: linear-gradient(160deg, var(--primary-light), var(--primary));
        color: white;
        padding: 20px;
        position: fixed;
        top: 0; left: 0;
        height: 100vh;
        overflow-y: auto;
        z-index: 300;
        transition: transform 0.3s ease;
        box-shadow: 4px 0 20px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
      }

      .sidebar-header { text-align: center; margin-bottom: 28px; padding-bottom: 16px; border-bottom: 2px solid rgba(255,255,255,0.25); }
      .sidebar-header h2 { font-size: 1.4rem; }
      .sidebar-header p { font-size: 0.8rem; opacity: 0.85; margin-top: 4px; }

      .sidebar-menu { list-style: none; flex: 1; }
      .sidebar-menu li { margin-bottom: 6px; }
      .sidebar-menu a {
        display: flex; align-items: center; gap: 10px;
        padding: 11px 14px;
        color: white; text-decoration: none;
        border-radius: 8px;
        transition: all 0.2s;
        font-size: 0.95rem;
      }
      .sidebar-menu a:hover,
      .sidebar-menu a.active { background: rgba(255,255,255,0.22); padding-left: 18px; }
      .sidebar-menu a i { width: 18px; text-align: center; }

      .logout-btn {
        margin-top: auto; padding: 11px 14px;
        background: rgba(255,255,255,0.18);
        border: none; color: white; border-radius: 8px;
        cursor: pointer; width: 100%; font-family: inherit;
        font-size: 0.95rem; display: flex; align-items: center; gap: 8px;
        transition: background 0.2s;
      }
      .logout-btn:hover { background: rgba(255,255,255,0.3); }

      /* â”€â”€ OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .sidebar-overlay {
        display: none; position: fixed; inset: 0;
        background: rgba(0,0,0,0.45); z-index: 200;
      }
      .sidebar-overlay.active { display: block; }

      /* â”€â”€ MAIN CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .main-content {
        margin-left: var(--sidebar-width);
        flex: 1; padding: 24px;
        min-width: 0;
      }

      /* â”€â”€ TOP HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .top-header {
        display: flex; align-items: center; gap: 12px;
        background: white; padding: 14px 20px;
        border-radius: 12px; margin-bottom: 24px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.06);
      }

      .menu-toggle {
        display: none;
        background: none; border: none; cursor: pointer;
        font-size: 1.2rem; color: #555; padding: 4px 8px;
        border-radius: 6px; transition: background 0.2s;
        flex-shrink: 0;
      }
      .menu-toggle:hover { background: #f0f4f8; }

      .sidebar-close {
        display: none;
        position: absolute; top: 14px; right: 14px;
        background: rgba(255,255,255,0.2); border: none;
        color: white; font-size: 1rem; width: 30px; height: 30px;
        border-radius: 50%; cursor: pointer;
        align-items: center; justify-content: center;
        transition: background 0.2s; z-index: 10;
      }
      .sidebar-close:hover { background: rgba(255,255,255,0.4); }

      .top-header h1 { font-size: clamp(1.2rem, 3vw, 1.8rem); color: #1a1a1a; flex: 1; }

      .btn {
        display: inline-flex; align-items: center; gap: 7px;
        padding: 10px 20px; border: none; border-radius: 8px;
        cursor: pointer; font-family: inherit; font-weight: 600;
        transition: all 0.2s; font-size: 0.9rem; white-space: nowrap;
      }
      .btn-primary { background: linear-gradient(135deg, var(--primary-light), var(--primary)); color: white; }
      .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(53,186,201,0.35); }
      .btn-danger { background: #e74c3c; color: white; }
      .btn-danger:hover { background: #c0392b; }
      .btn-secondary { background: #95a5a6; color: white; }
      .btn-secondary:hover { background: #7f8c8d; }
      .btn-sm { padding: 6px 12px; font-size: 0.8rem; }

      /* â”€â”€ ALERTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #alertContainer { margin-bottom: 16px; }

      .alert {
        padding: 13px 16px; margin-bottom: 10px;
        border-radius: 8px; display: none; font-size: 0.9rem;
      }
      .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
      .alert-error   { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
      .alert.show { display: flex; align-items: center; gap: 8px; animation: slideIn 0.3s ease; }

      @keyframes slideIn {
        from { opacity: 0; transform: translateY(-8px); }
        to   { opacity: 1; transform: translateY(0); }
      }

      /* â”€â”€ CARD WRAPPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .card {
        background: white; border-radius: 12px;
        padding: clamp(16px, 3vw, 28px);
        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      }
      .card h2 { margin-bottom: 20px; font-size: 1.2rem; }

      /* â”€â”€ TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .table-responsive { overflow-x: auto; border-radius: 12px; }
      .table-responsive table { width: 100%; border-collapse: collapse; min-width: 480px; }

      th {
        background: #f8f9fa; padding: 13px 14px;
        text-align: left; font-weight: 600; font-size: 0.85rem;
        border-bottom: 2px solid #eee; white-space: nowrap;
      }
      td { padding: 13px 14px; border-bottom: 1px solid #f0f0f0; font-size: 0.9rem; vertical-align: middle; }
      tr:last-child td { border-bottom: none; }
      tr:hover td { background: #fafbfc; }

      .status-badge {
        display: inline-block; padding: 4px 10px;
        border-radius: 20px; font-size: 0.78rem; font-weight: 600;
      }
      .status-published { background: #d4edda; color: #155724; }
      .status-draft     { background: #fff3cd; color: #856404; }

      .action-buttons { display: flex; gap: 6px; flex-wrap: wrap; }

      /* â”€â”€ FORMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .form-group { margin-bottom: 18px; }
      label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9rem; color: #2d2d2d; }

      input, textarea, select {
        width: 100%; padding: 11px 13px;
        border: 2px solid #e0e0e0; border-radius: 8px;
        font-family: inherit; font-size: 0.95rem;
        transition: border-color 0.2s; background: #fafafa;
      }
      input:focus, textarea:focus, select:focus {
        outline: none; border-color: var(--primary); background: white;
      }
      input:disabled { background: #f0f0f0; cursor: not-allowed; }
      textarea { resize: vertical; min-height: 260px; }

      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .form-actions {
        display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
        margin-top: 8px;
      }

      /* â”€â”€ UPLOAD AREA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .upload-zone {
        border: 2px dashed #ccc; border-radius: 8px;
        padding: 20px; text-align: center;
        cursor: pointer; transition: border-color 0.2s;
        background: #fafafa; position: relative;
      }
      .upload-zone:hover { border-color: var(--primary); }
      .upload-zone input[type="file"] {
        position: absolute; inset: 0; opacity: 0; cursor: pointer;
        width: 100%; height: 100%; padding: 0; border: none; background: none;
      }
      .upload-zone-label { pointer-events: none; color: #888; font-size: 0.9rem; }
      .upload-zone-label i { font-size: 1.6rem; color: var(--primary); display: block; margin-bottom: 6px; }

      #uploadPreview { margin-top: 12px; }
      #uploadPreview img, #uploadPreview video {
        max-width: 180px; max-height: 130px;
        border-radius: 8px; border: 2px solid #eee;
      }

      progress { width: 100%; height: 8px; border-radius: 4px; margin-top: 8px; }

      /* â”€â”€ LOADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .loader { text-align: center; padding: 40px; color: #aaa; }
      .spinner {
        border: 3px solid #f3f3f3; border-top: 3px solid var(--primary);
        border-radius: 50%; width: 36px; height: 36px;
        animation: spin 0.8s linear infinite; margin: 0 auto 10px;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* â”€â”€ PROFILE SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      #profileSection .card { max-width: 600px; }
      hr { border: none; border-top: 1px solid #eee; margin: 24px 0; }
      #profileSection h3 { margin-bottom: 16px; font-size: 1rem; }

      /* â”€â”€ HIDDEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .hidden { display: none !important; }

      /* â”€â”€ SIDEBAR CLOSE BTN (hidden on desktop) â”€â”€â”€â”€â”€â”€â”€â”€ */
      .sidebar-close {
        display: none;
        position: absolute; top: 14px; right: 14px;
        background: rgba(255,255,255,0.2); border: none;
        color: white; border-radius: 8px; width: 34px; height: 34px;
        align-items: center; justify-content: center;
        cursor: pointer; font-size: 1.1rem;
        transition: background 0.2s;
      }
      .sidebar-close:hover { background: rgba(255,255,255,0.35); }

      /* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      @media (max-width: 900px) {
        .sidebar { transform: translateX(-100%); position: fixed; }
        .sidebar.open { transform: translateX(0); }
        .main-content { margin-left: 0; }
        .menu-toggle { display: inline-flex; align-items: center; }
        .sidebar-close { display: flex; }
      }

      @media (max-width: 640px) {
        .main-content { padding: 12px; }
        .top-header { padding: 10px 12px; }
        .grid-2 { grid-template-columns: 1fr; }
        .form-actions { grid-template-columns: 1fr; }
        .btn { padding: 9px 14px; }

        /* â”€â”€ Card-style table on mobile (no horizontal scroll) â”€â”€ */
        .table-responsive { overflow-x: visible; }
        .table-responsive table { display: block; min-width: unset; }
        .table-responsive thead { display: none; }
        .table-responsive tbody { display: block; }
        .table-responsive tr {
          display: block;
          background: white;
          border-radius: 10px;
          margin-bottom: 12px;
          padding: 14px;
          box-shadow: 0 1px 6px rgba(0,0,0,0.07);
          border: 1px solid #eee;
        }
        .table-responsive td {
          display: flex;
          align-items: flex-start;
          gap: 8px;
          padding: 5px 0;
          border: none;
          font-size: 0.88rem;
        }
        .table-responsive td::before {
          content: attr(data-label);
          font-weight: 600;
          color: #999;
          font-size: 0.72rem;
          text-transform: uppercase;
          letter-spacing: 0.04em;
          min-width: 76px;
          flex-shrink: 0;
          padding-top: 3px;
        }
        .table-responsive td:last-child {
          padding-top: 10px;
          margin-top: 6px;
          border-top: 1px solid #f0f0f0;
          flex-direction: column;
        }
        .table-responsive td:last-child::before { content: ''; min-width: 0; }
        .action-buttons { flex-wrap: wrap; width: 100%; }
        .action-buttons .btn { flex: 1; justify-content: center; min-width: 80px; font-size: 0.8rem; }
      }

      @media (max-width: 400px) {
        .top-header h1 { font-size: 1.05rem; }
        .top-header .btn span { display: none; }
      }
    </style>
  </head>
  <body>

    <!-- â•â• LOGIN PAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="loginPage">
      <div class="login-box">
        <h2>ğŸ” NovaBuk Admin</h2>

        <!-- Login Form -->
        <form id="loginForm">
          <div id="loginAlert"></div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="loginEmail" required placeholder="admin@example.com" />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input type="password" id="loginPassword" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6" />
          </div>
          <button type="submit" class="btn btn-primary" style="width:100%">Login</button>
          <p style="text-align:center;margin-top:14px;color:#888;font-size:0.9rem">
            No account? <a href="#" id="registerToggle" style="color:var(--primary)">Register</a>
          </p>
        </form>

        <!-- Register Form -->
        <form id="registerForm" class="hidden">
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" id="registerName" required placeholder="Your name" />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="registerEmail" required placeholder="admin@example.com" />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input type="password" id="registerPassword" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6" />
          </div>
          <button type="submit" class="btn btn-primary" style="width:100%">Create Account</button>
          <p style="text-align:center;margin-top:14px;color:#888;font-size:0.9rem">
            Already have account? <a href="#" id="loginToggle" style="color:var(--primary)">Login</a>
          </p>
        </form>
      </div>
    </div>

    <!-- â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="dashboard" class="hidden">

      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <button class="sidebar-close" id="sidebarClose" aria-label="Close menu"><i class="fas fa-xmark"></i></button>
        <div class="sidebar-header">
          <h2>NovaBuk</h2>
          <p>Blog Admin</p>
        </div>
        <ul class="sidebar-menu">
          <li><a href="#" onclick="showSection('blogs')" class="menu-link active"><i class="fas fa-newspaper"></i> Blog Posts</a></li>
          <li><a href="#" onclick="editingBlogId=null; showSection('createBlog')" class="menu-link"><i class="fas fa-plus"></i> New Post</a></li>
          <li><a href="#" onclick="showSection('profile')" class="menu-link"><i class="fas fa-user"></i> Profile</a></li>
        </ul>
        <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </aside>

      <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

      <!-- Main -->
      <main class="main-content">

        <!-- Top Header -->
        <div class="top-header">
          <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu"><i class="fas fa-bars"></i></button>
          <h1 id="pageTitle">Blog Posts</h1>
          <button class="btn btn-primary" onclick="editingBlogId=null; showSection('createBlog')">
            <i class="fas fa-plus"></i><span>New Post</span>
          </button>
        </div>

        <div id="alertContainer"></div>

        <!-- â”€â”€ Blogs Section â”€â”€ -->
        <section id="blogsSection">
          <div class="card" style="padding:0;overflow:hidden">
            <div class="table-responsive">
              <table>
                <thead>
                  <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Published</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="blogsTable">
                  <tr><td colspan="5" class="loader"><div class="spinner"></div>Loadingâ€¦</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- â”€â”€ Create / Edit Section â”€â”€ -->
        <section id="createBlogSection" class="hidden">
          <div class="card">
            <h2 id="formTitle">Create New Blog Post</h2>
            <form id="blogForm">
              <input type="hidden" id="blogId" />

              <div class="form-group">
                <label>Title</label>
                <input type="text" id="blogTitle" required placeholder="Blog title" />
              </div>

              <div class="grid-2">
                <div class="form-group">
                  <label>Category</label>
                  <select id="blogCategory" required>
                    <option value="">Select Category</option>
                    <option value="healthcare">Healthcare</option>
                    <option value="technology">Technology</option>
                    <option value="innovation">Innovation</option>
                    <option value="tips">Tips &amp; Guides</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Read Time (minutes)</label>
                  <input type="number" id="blogReadTime" value="5" min="1" />
                </div>
              </div>

              <div class="form-group">
                <label>Excerpt / Summary</label>
                <textarea id="blogExcerpt" placeholder="Brief summaryâ€¦" style="min-height:80px"></textarea>
              </div>

              <div class="form-group">
                <label>Content</label>
                <textarea id="blogContent" required placeholder="Write your blog content hereâ€¦"></textarea>
              </div>

              <div class="grid-2">
                <div class="form-group">
                  <label>Author</label>
                  <input type="text" id="blogAuthor" value="NovaBuk Team" placeholder="Author name" />
                </div>
                <div class="form-group">
                  <label>Author Role</label>
                  <input type="text" id="blogAuthorRole" value="Content Team" placeholder="Author's role" />
                </div>
              </div>

              <div class="form-group">
                <label>Upload Image / Video</label>
                <div class="upload-zone" id="uploadZone">
                  <input type="file" id="blogFile" accept="image/*,video/*" />
                  <div class="upload-zone-label">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Click or drag a file here
                  </div>
                </div>
                <div id="uploadPreview"></div>
                <progress id="uploadProgressBar" value="0" max="100" style="display:none"></progress>
                <input type="hidden" id="blogImage" value="./images/image 34.png" />
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Draft</button>
                <button type="button" class="btn btn-secondary" onclick="saveBlogAndPublish()"><i class="fas fa-upload"></i> Save &amp; Publish</button>
              </div>
              <button type="button" class="btn btn-secondary" onclick="showSection('blogs')" style="width:100%;margin-top:10px">
                Cancel
              </button>
            </form>
          </div>
        </section>

        <!-- â”€â”€ Profile Section â”€â”€ -->
        <section id="profileSection" class="hidden">
          <div class="card">
            <h2>Admin Profile</h2>
            <form id="profileForm">
              <div class="form-group"><label>Name</label><input type="text" id="profileName" required /></div>
              <div class="form-group"><label>Email</label><input type="email" id="profileEmail" required /></div>
              <div class="form-group"><label>Role</label><input type="text" id="profileRole" disabled /></div>
              <hr />
              <h3>Change Password</h3>
              <div class="form-group"><label>Current Password</label><input type="password" id="currentPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6" /></div>
              <div class="grid-2">
                <div class="form-group"><label>New Password</label><input type="password" id="newPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6" /></div>
                <div class="form-group"><label>Confirm Password</label><input type="password" id="confirmPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6" /></div>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn btn-primary">Update Profile</button>
                <button type="button" class="btn btn-secondary" onclick="changePassword()">Change Password</button>
              </div>
            </form>
          </div>
        </section>

      </main>
    </div>

    <script>
      const API_URL = window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1"
        ? "http://localhost:5000/api"
        : "https://novabuk-backend.onrender.com/api";

      let authToken = localStorage.getItem("authToken");
      let currentUser = JSON.parse(localStorage.getItem("currentUser")) || null;
      let editingBlogId = null;

      // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      document.addEventListener("DOMContentLoaded", () => {
        if (authToken && currentUser) { showDashboard(); loadProfile(); }
        else showLoginPage();

        document.getElementById("loginForm").addEventListener("submit", handleLogin);
        document.getElementById("registerForm").addEventListener("submit", handleRegister);
        document.getElementById("blogForm").addEventListener("submit", handleBlogSubmit);
        document.getElementById("profileForm").addEventListener("submit", handleProfileSubmit);
        document.getElementById("registerToggle").addEventListener("click", e => { e.preventDefault(); toggleForms(); });
        document.getElementById("loginToggle").addEventListener("click", e => { e.preventDefault(); toggleForms(); });
        document.getElementById("menuToggle").addEventListener("click", toggleSidebar);
        document.getElementById("sidebarClose").addEventListener("click", closeSidebar);
        document.getElementById("blogFile").addEventListener("change", handleFileSelect);
      });

      // â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("open");
        document.getElementById("sidebarOverlay").classList.toggle("active");
      }
      function closeSidebar() {
        document.getElementById("sidebar").classList.remove("open");
        document.getElementById("sidebarOverlay").classList.remove("active");
      }
      // close sidebar on menu link click (mobile)
      document.querySelectorAll(".menu-link").forEach(l => l.addEventListener("click", () => { if (window.innerWidth <= 900) closeSidebar(); }));

      // â”€â”€ Forms / navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function toggleForms() {
        document.getElementById("loginForm").classList.toggle("hidden");
        document.getElementById("registerForm").classList.toggle("hidden");
      }

      function showSection(section) {
        ["blogsSection","createBlogSection","profileSection"].forEach(id => document.getElementById(id).classList.add("hidden"));
        document.querySelectorAll(".menu-link").forEach(l => l.classList.remove("active"));

        if (section === "blogs") {
          document.getElementById("blogsSection").classList.remove("hidden");
          document.getElementById("pageTitle").textContent = "Blog Posts";
          document.querySelector("[onclick=\"showSection('blogs')\"]").classList.add("active");
          loadBlogs();
        } else if (section === "createBlog") {
          if (!editingBlogId) {
            document.getElementById("blogForm").reset();
            document.getElementById("blogId").value = "";
            document.getElementById("formTitle").textContent = "Create New Blog Post";
            document.getElementById("pageTitle").textContent = "New Blog Post";
            document.getElementById("uploadPreview").innerHTML = "";
          } else {
            document.getElementById("pageTitle").textContent = "Edit Blog Post";
          }
          document.getElementById("createBlogSection").classList.remove("hidden");
        } else if (section === "profile") {
          document.getElementById("profileSection").classList.remove("hidden");
          document.getElementById("pageTitle").textContent = "Admin Profile";
          document.querySelector("[onclick=\"showSection('profile')\"]").classList.add("active");
          loadProfile();
        }
      }

      function showLoginPage()  { document.getElementById("dashboard").classList.add("hidden"); document.getElementById("loginPage").classList.remove("hidden"); }
      function showDashboard()  {
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("dashboard").classList.remove("hidden");
        showSection("blogs");
      }

      // â”€â”€ Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function handleLogin(e) {
        e.preventDefault();
        try {
          const res  = await fetch(`${API_URL}/admin/login`, { method:"POST", headers:{"Content-Type":"application/json"}, body: JSON.stringify({ email: document.getElementById("loginEmail").value, password: document.getElementById("loginPassword").value }) });
          const data = await res.json();
          if (data.success) {
            authToken = data.token; currentUser = data.admin;
            localStorage.setItem("authToken", authToken);
            localStorage.setItem("currentUser", JSON.stringify(currentUser));
            showAlert("Login successful!", "success", "loginAlert");
            setTimeout(() => { showDashboard(); }, 500);
          } else showAlert(data.message || "Login failed", "error", "loginAlert");
        } catch(err) { showAlert("Error: " + err.message, "error", "loginAlert"); }
      }

      async function handleRegister(e) {
        e.preventDefault();
        const name = document.getElementById("registerName").value;
        const email = document.getElementById("registerEmail").value;
        const password = document.getElementById("registerPassword").value;
        try {
          const res  = await fetch(`${API_URL}/admin/register`, { method:"POST", headers:{"Content-Type":"application/json"}, body: JSON.stringify({ name, email, password }) });
          const data = await res.json();
          if (data.success) {
            authToken = data.token; currentUser = { name, email, role:"admin" };
            localStorage.setItem("authToken", authToken);
            localStorage.setItem("currentUser", JSON.stringify(currentUser));
            showAlert("Account created! Redirectingâ€¦", "success", "loginAlert");
            setTimeout(() => { showDashboard(); loadProfile(); }, 500);
          } else showAlert(data.message || "Registration failed", "error", "loginAlert");
        } catch(err) { showAlert("Error: " + err.message, "error", "loginAlert"); }
      }

      function logout() {
        if (!confirm("Are you sure you want to logout?")) return;
        localStorage.removeItem("authToken"); localStorage.removeItem("currentUser");
        authToken = null; currentUser = null;
        showLoginPage();
        document.getElementById("loginForm").reset();
        document.getElementById("registerForm").reset();
      }

      // â”€â”€ Blogs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function loadBlogs() {
        try {
          const res  = await fetch(`${API_URL}/blogs/admin/all`, { headers:{ Authorization:`Bearer ${authToken}` } });
          const data = await res.json();
          const tbody = document.getElementById("blogsTable");
          if (!data.success) { showAlert(data.message, "error"); return; }
          tbody.innerHTML = "";
          if (!data.data.length) {
            tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;padding:40px;color:#aaa">No posts yet. <a href="#" onclick="editingBlogId=null;showSection('createBlog')" style="color:var(--primary)">Create one</a></td></tr>`;
            return;
          }
          data.data.forEach(blog => {
            const tr = document.createElement("tr");
            const publishBtn = blog.published ? "" : `<button class="btn btn-primary btn-sm" onclick="publishBlog('${blog._id}')"><i class="fas fa-upload"></i> Publish</button>`;
            tr.innerHTML = `
              <td data-label="Title"><strong>${blog.title}</strong></td>
              <td data-label="Category">${blog.category}</td>
              <td data-label="Status"><span class="status-badge ${blog.published ? 'status-published':'status-draft'}">${blog.published?'Published':'Draft'}</span></td>
              <td data-label="Published">${blog.publishedAt ? new Date(blog.publishedAt).toLocaleDateString() : 'â€”'}</td>
              <td><div class="action-buttons">
                <button class="btn btn-secondary btn-sm" onclick="editBlog('${blog._id}')"><i class="fas fa-edit"></i> Edit</button>
                ${publishBtn}
                <button class="btn btn-danger btn-sm" onclick="deleteBlog('${blog._id}')"><i class="fas fa-trash"></i> Delete</button>
              </div></td>`;
            tbody.appendChild(tr);
          });
        } catch(err) { showAlert("Error loading blogs: " + err.message, "error"); }
      }

      async function editBlog(blogId) {
        console.log("editBlog called with", blogId);
        try {
          const res = await fetch(`${API_URL}/blogs/admin/${blogId}`, { headers:{ Authorization:`Bearer ${authToken}` } });
          let data = null;
          try { data = await res.json(); } catch(e) {}
          if (res.ok && data && data.success) {
            const b = data.data;
            editingBlogId = b._id;
            console.log("loaded blog for edit, editingBlogId=", editingBlogId);
            document.getElementById("blogId").value = b._id;
            document.getElementById("blogTitle").value = b.title;
            document.getElementById("blogCategory").value = b.category;
            document.getElementById("blogExcerpt").value = b.excerpt;
            document.getElementById("blogContent").value = b.content;
            document.getElementById("blogAuthor").value = b.author;
            document.getElementById("blogAuthorRole").value = b.authorRole;
            document.getElementById("blogImage").value = b.image;
            document.getElementById("blogReadTime").value = b.readTime;
            document.getElementById("formTitle").textContent = "Edit Blog Post";
            if (b.image) showImagePreviewFromUrl(b.image);
            showSection("createBlog");
          } else {
            showAlert(`Error loading blog: ${res.status} ${res.statusText}`, "error");
          }
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      async function handleBlogSubmit(e) {
        e.preventDefault();
        const blogData = getBlogFormData(false);
        try {
          const method = editingBlogId ? "PUT" : "POST";
          const url    = editingBlogId ? `${API_URL}/blogs/${editingBlogId}` : `${API_URL}/blogs`;
          const res    = await fetch(url, { method, headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify(blogData) });
          const data   = await res.json();
          if (data.success) {
            showAlert(editingBlogId ? "Blog updated!" : "Blog saved as draft!", "success");
            setTimeout(() => { editingBlogId = null; showSection("blogs"); }, 1000);
          } else showAlert(data.message || "Error saving blog", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      async function saveBlogAndPublish() {
        const blogData = getBlogFormData(false);
        try {
          const method = editingBlogId ? "PUT" : "POST";
          const url    = editingBlogId ? `${API_URL}/blogs/${editingBlogId}` : `${API_URL}/blogs`;
          const res    = await fetch(url, { method, headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify(blogData) });
          const data   = await res.json();
          if (!data.success) { showAlert(data.message || "Error", "error"); return; }
          const blogId = editingBlogId || data.data._id;
          const pubRes = await fetch(`${API_URL}/blogs/${blogId}/publish`, { method:"PATCH", headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify({ published:true }) });
          const pubData = await pubRes.json();
          if (pubData.success) {
            showAlert("Blog published!", "success");
            setTimeout(() => { editingBlogId = null; showSection("blogs"); }, 1000);
          } else showAlert("Saved but error publishing", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      function getBlogFormData(published) {
        return {
          title:      document.getElementById("blogTitle").value,
          category:   document.getElementById("blogCategory").value,
          excerpt:    document.getElementById("blogExcerpt").value,
          content:    document.getElementById("blogContent").value,
          author:     document.getElementById("blogAuthor").value,
          authorRole: document.getElementById("blogAuthorRole").value,
          image:      document.getElementById("blogImage").value,
          readTime:   parseInt(document.getElementById("blogReadTime").value),
          published,
        };
      }

      async function deleteBlog(blogId) {
        if (!confirm("Delete this blog post?")) return;
        try {
          const res  = await fetch(`${API_URL}/blogs/${blogId}`, { method:"DELETE", headers:{ Authorization:`Bearer ${authToken}` } });
          const data = await res.json();
          if (data.success) { showAlert("Deleted!", "success"); loadBlogs(); }
          else showAlert(data.message || "Error", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      async function publishBlog(blogId) {
        if (!confirm("Publish this post?")) return;
        try {
          const res  = await fetch(`${API_URL}/blogs/${blogId}/publish`, { method:"PATCH", headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify({ published:true }) });
          const data = await res.json();
          if (data.success) { showAlert("Published!", "success"); loadBlogs(); }
          else showAlert(data.message || "Error", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      // â”€â”€ Profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function loadProfile() {
        try {
          const res  = await fetch(`${API_URL}/admin/me`, { headers:{ Authorization:`Bearer ${authToken}` } });
          const data = await res.json();
          if (data.success) {
            document.getElementById("profileName").value  = data.data.name;
            document.getElementById("profileEmail").value = data.data.email;
            document.getElementById("profileRole").value  = data.data.role;
          }
        } catch(err) { showAlert("Error loading profile", "error"); }
      }

      async function handleProfileSubmit(e) {
        e.preventDefault();
        try {
          const res  = await fetch(`${API_URL}/admin/profile`, { method:"PUT", headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify({ name: document.getElementById("profileName").value, email: document.getElementById("profileEmail").value }) });
          const data = await res.json();
          if (data.success) showAlert("Profile updated!", "success");
          else showAlert(data.message || "Error", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      async function changePassword() {
        const currentPassword = document.getElementById("currentPassword").value;
        const newPassword     = document.getElementById("newPassword").value;
        const confirmPassword = document.getElementById("confirmPassword").value;
        if (!currentPassword || !newPassword) { showAlert("Enter current and new password", "error"); return; }
        if (newPassword !== confirmPassword)   { showAlert("Passwords do not match", "error"); return; }
        try {
          const res  = await fetch(`${API_URL}/admin/change-password`, { method:"PUT", headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`}, body: JSON.stringify({ currentPassword, newPassword }) });
          const data = await res.json();
          if (data.success) {
            showAlert("Password changed!", "success");
            ["currentPassword","newPassword","confirmPassword"].forEach(id => document.getElementById(id).value = "");
          } else showAlert(data.message || "Error", "error");
        } catch(err) { showAlert("Error: " + err.message, "error"); }
      }

      // â”€â”€ Upload â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      async function handleFileSelect(e) {
        const file = e.target.files[0];
        if (!file) return;

        // local preview
        const preview = document.getElementById("uploadPreview");
        preview.innerHTML = "";
        const el = file.type.startsWith("video/") ? document.createElement("video") : document.createElement("img");
        el.src = URL.createObjectURL(file);
        if (file.type.startsWith("video/")) el.controls = true;
        preview.appendChild(el);

        try {
          const result = await uploadToCloudinary(file);
          if (result && result.secure_url) {
            document.getElementById("blogImage").value = result.secure_url;
            showImagePreviewFromUrl(result.secure_url);
            showAlert("Upload successful!", "success");
          } else showAlert("Upload failed", "error");
        } catch(err) {
          console.error("Upload error", err);
          showAlert("Upload error: " + (err.message || err), "error");
        }
      }

      async function uploadToCloudinary(file) {
        if (!authToken) throw new Error("Not authenticated");

        const signRes  = await fetch(`${API_URL}/uploads/cloudinary/sign`, { method:"POST", headers:{"Content-Type":"application/json", Authorization:`Bearer ${authToken}`} });
        const signData = await signRes.json();
        console.log("Backend /uploads/cloudinary/sign response:", signData);

        if (!signData.success) throw new Error(signData.message || "Could not get upload info");

        const cloudName   = signData.cloud_name || signData.cloudName;
        const uploadUrl   = signData.upload_url || (cloudName ? `https://api.cloudinary.com/v1_1/${cloudName}/auto/upload` : null);

        if (!uploadUrl) throw new Error("Cloudinary cloud name missing from backend response");

        const formData = new FormData();
        formData.append("file", file);

        if (signData.unsigned) {
          if (!signData.upload_preset) throw new Error("Unsigned upload requires upload_preset from server");
          formData.append("upload_preset", signData.upload_preset);
        } else {
          if (!signData.api_key) throw new Error("Backend error: Signed upload requires api_key.\nFix your backend to return: { api_key, signature, timestamp }");
          formData.append("api_key",    signData.api_key);
          formData.append("timestamp",  signData.timestamp);
          formData.append("signature",  signData.signature);
        }

        return await uploadWithXhr(uploadUrl, formData);
      }

      function uploadWithXhr(url, formData) {
        return new Promise((resolve, reject) => {
          const xhr = new XMLHttpRequest();
          xhr.open("POST", url);
          const bar = document.getElementById("uploadProgressBar");
          bar.style.display = "block"; bar.value = 0;
          xhr.upload.onprogress = e => { if (e.lengthComputable) bar.value = Math.round(e.loaded/e.total*100); };
          xhr.onload = () => {
            bar.style.display = "none";
            if (xhr.status >= 200 && xhr.status < 300) {
              try { resolve(JSON.parse(xhr.responseText)); } catch(err) { reject(err); }
            } else reject(new Error(`Upload failed: ${xhr.status} ${xhr.statusText} - ${xhr.responseText}`));
          };
          xhr.onerror = () => { bar.style.display = "none"; reject(new Error("Network error during upload")); };
          xhr.send(formData);
        });
      }

      function showImagePreviewFromUrl(url) {
        if (!url) return;
        const preview = document.getElementById("uploadPreview");
        if (!preview) return;
        preview.innerHTML = "";
        const src = url + (url.includes("?")?"&":"?") + "cb=" + Date.now();
        const el  = /(\.mp4|\.webm|\.ogg)(\?|$)/i.test(url) || url.includes("video") ? document.createElement("video") : document.createElement("img");
        el.src = src;
        if (el.tagName === "VIDEO") el.controls = true;
        preview.appendChild(el);
      }

      // â”€â”€ Alert helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function showAlert(message, type, elementId = "alertContainer") {
        const container = document.getElementById(elementId);
        if (!container) return;
        const el = document.createElement("div");
        el.className = `alert alert-${type}`;
        el.innerHTML = `<i class="fas fa-${type==='success'?'check-circle':'exclamation-circle'}"></i> ${message}`;
        container.appendChild(el);
        setTimeout(() => el.classList.add("show"), 10);
        setTimeout(() => { el.classList.remove("show"); setTimeout(() => el.remove(), 300); }, 5000);
      }
    </script>
  </body>
</html>
