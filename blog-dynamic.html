<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles.css" />
    <!-- <link rel="stylesheet" href="./styles-about.css"> -->
    <link rel="stylesheet" href="./styles-blog.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Unbounded:wght@200..900&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <title>Blog - NovaBuk</title>
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <div class="header">
        <div class="navbar">
          <div class="logo"><img src="./images/logo.png" alt="" /></div>

          <button
            id="navToggle"
            class="nav-toggle"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>

          <div class="nav-menu" id="navMenu">
            <ul>
              <li><a href="./index.html">Home</a></li>
              <li><a href="./about.html">About Us</a></li>
              <li><a href="./services.html">Features</a></li>
              <li><a href="./blog-dynamic.html" class="active">Blog</a></li>
              <li><a href="./contact.html">Contact</a></li>
            </ul>
          </div>
        </div>
        <div class="hero">
          <div class="hero-content">
            <h1>Healthcare Insights & Innovation</h1>
            <p>
              Stay updated with the latest trends in digital health, AI-driven
              medical records, and healthcare innovation across Africa
            </p>
          </div>
          <!-- <div class="button">
                <a href="./services.html" class="btn-primary"
                >Get Started &nbsp; &nbsp;
                <span><i class="fa-solid fa-arrow-right"></i></span
                ></a>
                <a href="#" class="btn-secondary">join Our Pilot Clinics</a>
            </div> -->
        </div>
        <div class="header-img slider">
          <div class="slides">
            <img src="./images/Frame 1000015259.png" alt="" />
            <img src="./images/image 31.png" alt="" />
            <img src="./images/image 30.png" alt="" />
          </div>
        </div>
      </div>

      <!-- <div class="blog-header">
        <div class="navbar">
          <div class="logo">
            <img src="./images/logo.png" alt="NovaBuk Logo" />
          </div>
          <button
            id="navToggle"
            class="nav-toggle"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>
          <div class="nav-menu" id="navMenu">
            <ul>
              <li><a href="./index.html">Home</a></li>
              <li><a href="./about.html">About Us</a></li>
              <li><a href="./services.html">Features</a></li>
              <li><a href="./blog.html" class="active">Blog</a></li>
              <li><a href="./contact.html">Contact</a></li>
            </ul>
          </div>
        </div>
        <div class="blog-hero">
          <div class="blog-hero-content">
            <h1>Healthcare Insights & Innovation</h1>
            <p>
              Stay updated with the latest trends in digital health, AI-driven
              medical records, and healthcare innovation across Africa
            </p>
          </div>
        </div>
      </div> -->

      <!-- Featured Post Section -->
      <section class="featured-post-section" id="featuredSection">
        <div class="loader" style="text-align: center; padding: 40px">
          <div
            class="spinner"
            style="
              border: 4px solid #f3f3f3;
              border-top: 4px solid #35bac9;
              border-radius: 50%;
              width: 40px;
              height: 40px;
              animation: spin 1s linear infinite;
              margin: 0 auto;
            "
          ></div>
        </div>
      </section>

      <!-- Search & Filter Section -->
      <section class="blog-search-section">
        <div class="search-container">
          <input
            type="text"
            id="blogSearch"
            class="blog-search-input"
            placeholder="Search articles..."
          />
          <button class="search-btn"><i class="fas fa-search"></i></button>
        </div>
        <div class="filter-tags">
          <button class="filter-btn active" data-filter="all">All Posts</button>
          <button class="filter-btn" data-filter="healthcare">
            Healthcare
          </button>
          <button class="filter-btn" data-filter="technology">
            Technology
          </button>
          <button class="filter-btn" data-filter="innovation">
            Innovation
          </button>
          <button class="filter-btn" data-filter="tips">Tips & Guides</button>
        </div>
      </section>

      <!-- Blog Posts Grid -->
      <section class="blog-posts-grid" id="blogsGrid">
        <div
          class="loader"
          style="grid-column: 1 / -1; text-align: center; padding: 40px"
        >
          <div
            class="spinner"
            style="
              border: 4px solid #f3f3f3;
              border-top: 4px solid #35bac9;
              border-radius: 50%;
              width: 40px;
              height: 40px;
              animation: spin 1s linear infinite;
              margin: 0 auto;
            "
          ></div>
        </div>
      </section>

      <!-- Newsletter Section -->
      <section class="newsletter-section">
        <div class="newsletter-content">
          <h2>Stay Updated with Healthcare Insights</h2>
          <p>
            Subscribe to our newsletter for the latest updates on digital health
            innovation and tips for healthcare providers.
          </p>
          <form class="newsletter-form">
            <input type="email" placeholder="Enter your email" required />
            <button type="submit" class="btn-primary">Subscribe</button>
          </form>
        </div>
      </section>

      <!-- Footer -->
     <footer>
        <div class="navbar">
          <div class="logo"><img src="./images/logo.png" alt="" /></div>
          <div class="foot-menu">
            <ul>
              <li><a href="./index.html">Home</a></li>
              <li><a href="./about.html">About Us</a></li>
              <li><a href="./services.html">Features</a></li>
              <li><a href="./contact.html">Contact</a></li>
            </ul>
          </div>
          <div class="foot-menu" id="foot-menu">
            <ul>
              <li>
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
              </li>
              <li>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
              </li>
              <li>
                <a href="#"><i class="fa-brands fa-linkedin"></i></a>
              </li>
            </ul>
          </div>
        </div>
        <div class="line"></div>
        <div class="navfoot">
          <div class="foot-menu" id="foot-menu-two">
            <ul style="display: flex">
              <li><a href="./text.txt">Terms of Service</a></li>
              <li><a href="">Policy Privacy</a></li>
            </ul>
          </div>
          <div class="foot-menu">
            <ul style="display: flex">
              <li>
                <a href=""
                  ><i class="fa-regular fa-copyright"></i>Copyright 2025
                  NovaBuk.All rights reserved</a
                >
              </li>
            </ul>
          </div>
        </div>
      </footer>
    </div>

    <script src="./script.js"></script>
    <script>
      // API Configuration
      const API_URL =
        window.location.hostname === "localhost" ||
        window.location.protocol === "file:"
          ? "http://localhost:5000/api"
          : "https://novabuk-backend.onrender.com/api";
      let allBlogs = [];
      let filteredBlogs = [];

      // Load blogs on page load
      document.addEventListener("DOMContentLoaded", () => {
        loadBlogs();
        setupEventListeners();
      });

      // Load all blogs from backend
      async function loadBlogs() {
        try {
          const response = await fetch(`${API_URL}/blogs?limit=100`);
          const data = await response.json();

          if (data.success && data.data) {
            allBlogs = data.data;
            filteredBlogs = [...allBlogs];

            // Display featured blog
            displayFeaturedBlog();

            // Display all blogs
            displayBlogs(filteredBlogs);
          } else {
            console.error("No blogs found");
            document.getElementById("blogsGrid").innerHTML =
              '<p style="grid-column: 1 / -1; text-align: center; padding: 40px;">No blog posts yet. Check back soon!</p>';
          }
        } catch (error) {
          console.error("Error loading blogs:", error);
          document.getElementById("blogsGrid").innerHTML =
            '<p style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #e74c3c;">Error loading blog posts. Please try again later.</p>';
        }
      }

      // Helper to ensure valid image URL and fallback
      function safeUrl(url) {
        if (!url) return './images/image 34.png';
        try {
          // If already an absolute URL, return as-is
          if (/^https?:\/\//i.test(url)) return url;
          // Otherwise encode spaces and return
          return encodeURI(url);
        } catch (err) {
          return './images/image 34.png';
        }
      }

      // Display featured blog (most recent published)
      function displayFeaturedBlog() {
        const featured = allBlogs[0]; // Most recent published first

        if (!featured) {
          document.getElementById("featuredSection").innerHTML = "";
          return;
        }

        document.getElementById("featuredSection").innerHTML = `
                <div class="featured-post">
                    <div class="featured-post-content">
                        <span class="post-badge">Featured</span>
                        <h2>${featured.title}</h2>
                        <p>${featured.excerpt || featured.content.substring(0, 200)}</p>
                        <div class="post-meta">
                            <span class="post-date"><i class="fas fa-calendar"></i> ${new Date(featured.publishedAt).toLocaleDateString()}</span>
                            <span class="post-author"><i class="fas fa-user"></i> ${featured.author}</span>
                            <span class="read-time"><i class="fas fa-clock"></i> ${featured.readTime} min read</span>
                        </div>
                        <a href="./blog-single.html?slug=${featured.slug}" class="read-more-btn">Read Full Article <i class="fas fa-arrow-right"></i></a>
                    </div>
                    <div class="featured-post-image">
                      <img src="${safeUrl(featured.image)}" alt="${featured.title}">
                    </div>
                </div>
            `;
      }

      // Display blogs grid
      function displayBlogs(blogs) {
        const blogsGrid = document.getElementById("blogsGrid");

        if (blogs.length === 0) {
          blogsGrid.innerHTML =
            '<p style="grid-column: 1 / -1; text-align: center; padding: 40px;">No blog posts found. Try a different search or filter.</p>';
          return;
        }

        blogsGrid.innerHTML = blogs
          .map(
            (blog) => `
                <article class="blog-card" data-category="${blog.category}">
                    <div class="blog-card-image">
                        <img src="${safeUrl(blog.image)}" alt="${blog.title}">
                        <span class="category-badge">${capitalizeFirst(blog.category)}</span>
                    </div>
                    <div class="blog-card-content">
                        <h3>${blog.title}</h3>
                        <p>${blog.excerpt || blog.content.substring(0, 150)}</p>
                        <div class="post-meta">
                            <span class="post-date"><i class="fas fa-calendar"></i> ${new Date(blog.publishedAt).toLocaleDateString()}</span>
                            <span class="read-time"><i class="fas fa-clock"></i> ${blog.readTime} min read</span>
                        </div>
                        <a href="./blog-single.html?slug=${blog.slug}" class="read-link">Read Article <i class="fas fa-arrow-right"></i></a>
                    </div>
                </article>
            `,
          )
          .join("");
      }

      // Setup event listeners
      function setupEventListeners() {
        // Filter buttons
        document.querySelectorAll(".filter-btn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            document
              .querySelectorAll(".filter-btn")
              .forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");

            const filter = btn.getAttribute("data-filter");
            if (filter === "all") {
              filteredBlogs = [...allBlogs];
            } else {
              filteredBlogs = allBlogs.filter(
                (blog) => blog.category === filter,
              );
            }
            displayBlogs(filteredBlogs);
          });
        });

        // Search
        document.getElementById("blogSearch").addEventListener("input", (e) => {
          const query = e.target.value.toLowerCase();
          filteredBlogs = allBlogs.filter(
            (blog) =>
              blog.title.toLowerCase().includes(query) ||
              blog.excerpt.toLowerCase().includes(query) ||
              blog.content.toLowerCase().includes(query),
          );
          displayBlogs(filteredBlogs);
        });

        // Newsletter
        document
          .querySelector(".newsletter-form")
          .addEventListener("submit", (e) => {
            e.preventDefault();
            const email = e.target.email.value;
            alert(
              "Thank you for subscribing! You will receive updates at " + email,
            );
            e.target.reset();
          });
      }

      // Helper function
      function capitalizeFirst(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
      }
    </script>
  </body>
</html>
